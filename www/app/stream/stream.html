<!-- ion-nav-bar goes here -->
<ion-view title="Streams">
    <!-- ion-header-bar -->

  <div id="stream-header">
    <ion-header-bar align-title="center" class="bar">
        <!-- Hamburger Button -->

      <left-nav-toggle-btn></left-nav-toggle-btn>
      <h1 class="title" ng-click="toggleStreamItemFilters()">
        {{selectedStreamItemFilter.displayName}}
      </h1>
      <span class="icon ion-chevron-down filter-chevron"  ng-class="{'ion-chevron-down':!showStreamItemFilters,'ion-chevron-up':showStreamItemFilters }"></span>
      <div class="buttons">
        <button class="button button-clear icon sprout-icon-notification"></button>
      </div>

    </ion-header-bar>
    <div class="bar bar-loading bar-assertive" ng-if="isSyncing">
      Loading...
    </div>
    <!-- Filter dropdown -->
    <div class="row stream-item-filter" ng-show="showStreamItemFilters">
      <div class="leadboardFilterRow row" ng-repeat="filter in streamItemFilters" ng-class="{selected : (filter.filterId == selectedStreamItemFilter.filterId)}">
         <h5 class="col" ng-click="selectStreamItemFilter(filter)" ng-class="{!filter.subFilters}"> {{filter.displayName}} </h5>
         <i ng-if="filter.filterId == selectedStreamItemFilter.filterId" class="icon ion-checkmark-circled calm"></i>
        <i ng-if="filter.subFilters" class="icon ion-chevron-right" ng-click="showSubStreamItemFilters(filter)"></i>
      </div>
    </div>
    <div class="row create-post">
      <div class="col">
        <span class="icon ion-ios7-compose-outline"></span>
        <a ng-click="createPost()" href="javascript:void(0)">Post To Stream</a>
      </div>
      <div class="vertical-divider"></div>
      <div class="col">
        <span class="icon ion-ios7-stopwatch-outline"></span>
        <a ng-click="createActivity()" href="javascript:void(0)">Track Activities</a>
      </div>
    </div>
    <div class="row new-items-notification" ng-show="updatePresent" ng-click="applyNewItems(true)">
      <div>
        <span class="icon ion-chevron-up"></span><br />
        {{updatePresent}} new items
      </div>
    </div>
  </div>

  <div ng-if="APP_CONFIG.useFastStreams">
    <ion-content
      id="sproutPostsScroller"
      delegate-handle="streamScroller"
      header-shrink
      scroll-event-interval="5">
        <ion-refresher on-refresh="onRefreshPullDown()"
          pulling-text="Pull to refresh..."
          refreshing-text="Refreshing!"
          refreshing-icon="ion-loading-c"
          >
        </ion-refresher>
        <stream></stream>
      </ion-content>
  </div>

  <div ng-if="!APP_CONFIG.useFastStreams">
    <ion-content id="sproutPostsScrollerOld"
      delegate-handle="streamScrollerOld"
      header-shrink
      scroll-event-interval="5">
        <ion-refresher on-refresh="onRefreshPullDown()"
          pulling-text="Pull to refresh..."
          refreshing-text="Refreshing!"
          refreshing-icon="ion-loading-c"
          >
        </ion-refresher>
        <div class="item post" ng-repeat="post in stream.items track by post.streamItemId"
          data-modal="modal" data-dialog="dialog">
            <post post="post" show-comment-box="true" modal-container="streamItemModal"
             is-wrapped-in-modal="false" view-type="'COMMENTS'"></post>
        </div>
        <ion-infinite-scroll
          on-infinite="performInfiniteScroll()"
          icon="ion-loading-c"
          distance="1%">
        </ion-infinite-scroll>
    </ion-content>
  </div>

  <div ng-show="showOfflineMsg" style="text-align: center">Please reconnect to the internet to view older streams...</div>

  <ion-content ng-show="status=='NO_CONNECTION'">
  <ng-include src="'app/stream/no-connection.tpl.html'"></ng-include>
  </ion-content>
  <ion-content ng-show="status=='NO_STREAM_ITEMS_FOUND'">
    <ng-include src="'app/stream/no-streams.tpl.html'"></ng-include>
  </ion-content>
</ion-view>
