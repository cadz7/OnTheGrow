<!--NOTE: The scope of controller is generated by stream-ctrl.js-->

<div class="modal create-activity-modal" ng-controller="ActivityBarCtrl">
  <ion-header-bar>
    <button class="button button-icon icon sprout-icon-close" ng-click="cancel()"></button>
    <h1 class="title">TRACK ACTIVITIES</h1>
    <button class="button button-clear post active" ng-show="activtyQueue && activtyQueue.length > 0" ng-click="saveActivities()" ng-disabled="savingActivities">SUBMIT</button>
    <div ng-show="errorMessage.length > 0" style="color:red">{{errorMessage}}</div>
  </ion-header-bar>
  <ion-content class="padding has-header add-activity-post">

<div class="list create-post-input">
  <label class="item item-input">
    <input type="text" ng-model="newPost.text" placeholder="e.g. - Cardio, Housework, Veggies...">
    <i class="icon ion-ios7-search placeholder-icon"></i>
  </label>
</div>
    <div class="activity-select">
      <div class="row">
          <span class="breadcrumb" ng-click="backtrackBreadcrumb()" ng-hide="currentState == 0"><i class="icon ion-chevron-left"></i> back</span>
        <div class="col">
          <h3 class="activity-title"> {{ title }}</h3>
          <hr>
        </div>
      </div>

      <div class="list" ng-show="activityListVisible">
        <div class="col col-50 activity-item-container" ng-repeat="item in activityData">
          <div class="activity-item" ng-click="onItemSelect(item)">{{item[nameKey]}}</div>
        </div>
      </div>

      <form name="activityForm" ng-show="showActivityForm" >
        <div class="row" >
          <div class="col col-50">
            <label class="item item-input item-stacked-label">
              <span class="input-label">Activity</span>
              <input type="text" class="ellipsis" ng-model="currentActivity.activityName" readonly required/>
            </label>
          </div>

          <div class="col col-50">
            <label class="item item-input item-stacked-label">
              <span class="input-label">Date</span>
              <input type="date" name="date" ng-model="currentActivity.date" max="{{maxDate}}" required placeholder="yyyy-MM-dd" style="padding-left: 0px"/>
              <span class="input-label"  style="color:red" ng-show="activityForm.date.$error.required">Date Required!</span>
            </label>
          </div>
        </div>

        <div class="row">
          <ion-radio ng-model="selectedActivityUnit" ng-value="unit" ng-change="activityUnitSelected(unit)" ng-repeat="unit in currentActivityUnits">{{unit.unitName}}</ion-radio>
        </div>

        <div class="row" >
          <div class="col">
            <label class="item item-input item-stacked-label">
              <span class="input-label">Quantity ({{currentActivity.unitName}})</span>
              <!-- <input type="number" name="quantity" placeholder="{{currentActivity.unitName}}" ng-model="currentActivity.quantity" required min="1" readonly style="text-align: center" ng-click="showNumpad = !showNumpad"/> -->
                <!-- <numpad ng-show="showNumpad" model="currentActivity.quantity" accept="alert()"></numpad> -->
              <input class="enableTap" name="quantity" type="number" min="1" ng-attr-placeholder="{{currentActivity.unitName}}" ng-model="currentActivity.quantity" inputmode="numeric" pattern="[0-9]*"/>
              <span class="input-label"  style="color:red" ng-show="activityForm.quantity.$error.required">Number Required!</span>
            </label>
          </div>
        </div>

        <div class="row">
          <div class="col" style="text-align: right">
            <span style="color:red">{{errorMessage}}</span>
            <button class="button button-balanced" ng-click="addActivity()" ng-disabled="!activityForm.$valid || savingActivity">Add</button>
            <button class="button button-assertive" ng-click="clearActivity()">Clear</button>
          </div>
        </div>
      </form>

      <div class="row">
        <div class="col">
          <h3 class="activity-title">Activity Queue</h3>
          <hr>
        </div>
      </div>
      <div class="row" ng-show="!activtyQueue || activtyQueue.length === 0">
        <div class="col">
          <span class="subdued">No Activites Selected<span>
        </div>
      </div>
      <ion-list  show-delete="true" >
        <ion-item ng-repeat="activity in activtyQueue" class="item-thumbnail-right activity-queue-item" ng-click="restoreActivity(activity)">
          You tracked {{activity.quantity}} {{activity.unitName}} of {{activity.activityName}}
          <ion-delete-button class="ion-minus-circled" ng-click="activtyQueue.splice($index, 1)">
        </ion-item>
      </ion-list>

    </div>
  </ion-content>
</div>
